# æŠ¤ç…§ç­¾è¯ç®¡ç†ç³»ç»Ÿ

ä¸€ä¸ªç°ä»£åŒ–çš„æŠ¤ç…§å’Œç­¾è¯ç®¡ç†ç³»ç»Ÿï¼Œæä¾›å®Œæ•´çš„å®¢æˆ·ç®¡ç†ã€æŠ¤ç…§è·Ÿè¸ªã€ç­¾è¯åˆ°æœŸæé†’å’Œé€šçŸ¥åŠŸèƒ½ã€‚

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- **å®¢æˆ·ç®¡ç†** - ç®¡ç†å®¢æˆ·ä¿¡æ¯ï¼Œæ”¯æŒå®¢æˆ·åˆ†ç»„å’Œå¤‡æ³¨
- **æŠ¤ç…§ç®¡ç†** - å®Œæ•´çš„æŠ¤ç…§ä¿¡æ¯ç®¡ç†ï¼ŒåŒ…æ‹¬åˆ°æœŸæ—¥æœŸè·Ÿè¸ª
- **ç­¾è¯ç®¡ç†** - ç­¾è¯ä¿¡æ¯å½•å…¥å’Œåˆ°æœŸæé†’
- **é€¾æœŸç®¡ç†** - è‡ªåŠ¨æ£€æµ‹æŠ¤ç…§å’Œç­¾è¯çš„é€¾æœŸæƒ…å†µ
- **é€šçŸ¥ç³»ç»Ÿ** - åŸºäº Telegram çš„åˆ°æœŸæé†’é€šçŸ¥
- **ç”¨æˆ·ç®¡ç†** - å¤šç”¨æˆ·æƒé™ç®¡ç†
- **æ“ä½œæ—¥å¿—** - å®Œæ•´çš„å®¡è®¡æ—¥å¿—è®°å½•

### æŠ€æœ¯ç‰¹æ€§
- **ç°ä»£åŒ–å‰ç«¯** - React + TypeScript + Ant Design
- **é«˜æ€§èƒ½åç«¯** - NestJS + Prisma + PostgreSQL
- **å®æ—¶é€šçŸ¥** - Telegram Bot é›†æˆ
- **å“åº”å¼è®¾è®¡** - æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡
- **æ•°æ®å®‰å…¨** - JWT è®¤è¯å’Œå¯†ç åŠ å¯†

## ğŸ›  æŠ€æœ¯æ ˆ

### å‰ç«¯ (web/)
- **React 18** - ç”¨æˆ·ç•Œé¢æ¡†æ¶
- **TypeScript** - ç±»å‹å®‰å…¨
- **Ant Design** - UI ç»„ä»¶åº“
- **React Router** - è·¯ç”±ç®¡ç†
- **Axios** - HTTP å®¢æˆ·ç«¯
- **Vite** - æ„å»ºå·¥å…·

### åç«¯ (server/)
- **NestJS** - Node.js æ¡†æ¶
- **Prisma** - æ•°æ®åº“ ORM
- **PostgreSQL** - æ•°æ®åº“
- **JWT** - èº«ä»½è®¤è¯
- **Passport** - è®¤è¯ç­–ç•¥
- **Cron** - å®šæ—¶ä»»åŠ¡

### åŸºç¡€è®¾æ–½
- **Docker Compose** - å®¹å™¨åŒ–éƒ¨ç½²
- **PostgreSQL 16** - æ•°æ®åº“æœåŠ¡

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- Node.js 18+
- Docker & Docker Compose
- Git

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd visa
```

### 2. å¯åŠ¨æ•°æ®åº“
```bash
docker-compose up -d
```

### 3. å®‰è£…ä¾èµ–
```bash
# å®‰è£…åç«¯ä¾èµ–
cd server
npm install

# å®‰è£…å‰ç«¯ä¾èµ–
cd ../web
npm install
```

### 4. ç¯å¢ƒé…ç½®
åœ¨ `server/` ç›®å½•ä¸‹åˆ›å»º `.env` æ–‡ä»¶ï¼š
```env
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/visa"
JWT_SECRET="your-jwt-secret-key"
PORT=3000
```

### 5. æ•°æ®åº“è¿ç§»
```bash
cd server
npm run prisma:generate
npm run prisma:migrate
npm run prisma:seed
```

### 6. å¯åŠ¨æœåŠ¡
```bash
# å¯åŠ¨åç«¯æœåŠ¡
cd server
npm run start:dev

# å¯åŠ¨å‰ç«¯æœåŠ¡ï¼ˆæ–°ç»ˆç«¯ï¼‰
cd web
npm run dev
```

### 7. è®¿é—®åº”ç”¨
- å‰ç«¯: http://localhost:5173
- åç«¯ API: http://localhost:3000

## ğŸ“ é¡¹ç›®ç»“æ„

```
visa/
â”œâ”€â”€ docker-compose.yml          # Docker é…ç½®
â”œâ”€â”€ README.md                   # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ server/                     # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ auth/              # è®¤è¯æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ clients/           # å®¢æˆ·ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ passports/         # æŠ¤ç…§ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ visas/             # ç­¾è¯ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ overdue/           # é€¾æœŸç®¡ç†
â”‚   â”‚   â”œâ”€â”€ notify/            # é€šçŸ¥ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ users/             # ç”¨æˆ·ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ audit/             # å®¡è®¡æ—¥å¿—
â”‚   â”‚   â””â”€â”€ prisma/            # æ•°æ®åº“æœåŠ¡
â”‚   â”œâ”€â”€ prisma/
â”‚   â”‚   â”œâ”€â”€ schema.prisma      # æ•°æ®åº“æ¨¡å‹
â”‚   â”‚   â””â”€â”€ seed.ts            # åˆå§‹æ•°æ®
â”‚   â””â”€â”€ package.json
â””â”€â”€ web/                       # å‰ç«¯åº”ç”¨
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ pages/             # é¡µé¢ç»„ä»¶
    â”‚   â”œâ”€â”€ api/               # API æ¥å£
    â”‚   â””â”€â”€ App.tsx            # ä¸»åº”ç”¨
    â””â”€â”€ package.json
```

## ğŸ”§ å¼€å‘æŒ‡å—

### åç«¯å¼€å‘
```bash
cd server

# å¼€å‘æ¨¡å¼
npm run start:dev

# æ•°æ®åº“æ“ä½œ
npm run prisma:generate    # ç”Ÿæˆ Prisma å®¢æˆ·ç«¯
npm run prisma:migrate     # è¿è¡Œæ•°æ®åº“è¿ç§»
npm run prisma:seed        # å¡«å……åˆå§‹æ•°æ®

# æµ‹è¯•
npm run test
npm run test:e2e
```

### å‰ç«¯å¼€å‘
```bash
cd web

# å¼€å‘æ¨¡å¼
npm run dev

# æ„å»º
npm run build

# ä»£ç æ£€æŸ¥
npm run lint
```

## ğŸ“Š æ•°æ®åº“æ¨¡å‹

### ä¸»è¦å®ä½“
- **User** - ç³»ç»Ÿç”¨æˆ·
- **Client** - å®¢æˆ·ä¿¡æ¯
- **Passport** - æŠ¤ç…§ä¿¡æ¯
- **Visa** - ç­¾è¯ä¿¡æ¯
- **NotifySetting** - é€šçŸ¥è®¾ç½®
- **TelegramWhitelist** - Telegram ç™½åå•
- **AuditLog** - å®¡è®¡æ—¥å¿—

## ğŸ” è®¤è¯ä¸æˆæƒ

ç³»ç»Ÿä½¿ç”¨ JWT è¿›è¡Œèº«ä»½è®¤è¯ï¼š
- ç”¨æˆ·ç™»å½•åè·å¾— JWT Token
- Token å­˜å‚¨åœ¨ localStorage
- æ‰€æœ‰ API è¯·æ±‚éœ€è¦æºå¸¦ Token
- æ”¯æŒ Token è¿‡æœŸè‡ªåŠ¨è·³è½¬ç™»å½•

## ğŸ“± é€šçŸ¥ç³»ç»Ÿ

### Telegram é›†æˆ
- æ”¯æŒ Telegram Bot é€šçŸ¥
- å¯é…ç½®å¤šä¸ªåˆ°æœŸæé†’é˜ˆå€¼ï¼ˆ15å¤©ã€30å¤©ã€90å¤©ã€180å¤©ï¼‰
- æ”¯æŒç™½åå•ç®¡ç†
- å®æ—¶é€šçŸ¥å‘é€çŠ¶æ€

### é€šçŸ¥é…ç½®
1. åœ¨ Telegram ä¸­åˆ›å»º Bot
2. è·å– Bot Token
3. åœ¨ç³»ç»Ÿä¸­é…ç½® Token
4. æ·»åŠ ç”¨æˆ·åˆ°ç™½åå•
5. æµ‹è¯•é€šçŸ¥åŠŸèƒ½

## ğŸš€ éƒ¨ç½²

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
```bash
# æ„å»ºå‰ç«¯
cd web
npm run build

# æ„å»ºåç«¯
cd server
npm run build

# ä½¿ç”¨ Docker éƒ¨ç½²
docker-compose -f docker-compose.prod.yml up -d
```

### ç¯å¢ƒå˜é‡
ç”Ÿäº§ç¯å¢ƒéœ€è¦é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š
- `DATABASE_URL` - æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
- `JWT_SECRET` - JWT å¯†é’¥
- `PORT` - æœåŠ¡ç«¯å£
- `NODE_ENV` - ç¯å¢ƒæ ‡è¯†

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ æ”¯æŒ

å¦‚æœæ‚¨é‡åˆ°ä»»ä½•é—®é¢˜æˆ–æœ‰å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ [Issues](../../issues)
2. åˆ›å»ºæ–°çš„ Issue
3. è”ç³»å¼€å‘å›¢é˜Ÿ

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªå†…éƒ¨ç®¡ç†ç³»ç»Ÿï¼Œè¯·ç¡®ä¿åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ­£ç¡®é…ç½®å®‰å…¨è®¾ç½®ã€‚
